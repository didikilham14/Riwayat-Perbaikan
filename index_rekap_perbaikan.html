
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rekap Perbaikan Mesin</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    input, select, button { margin: 5px 0; padding: 5px; }
  </style>
</head>
<body>
  <h1>Rekap Perbaikan Mesin</h1>
  <form id="repairForm">
    <label>Nama Teknisi: <input type="text" id="teknisi" required /></label><br />
    <label>Mesin: <input type="text" id="mesin" required /></label><br />
    <label>Kerusakan: <input type="text" id="kerusakan" required /></label><br />
    <label>Tindakan: <input type="text" id="tindakan" required /></label><br />
    <label>Tanggal: <input type="date" id="tanggal" required /></label><br />
    <label>Shift:
      <select id="shift">
        <option value="Pagi">Pagi</option>
        <option value="Sore">Sore</option>
        <option value="Malam">Malam</option>
      </select>
    </label><br />
    <button type="submit">Tambah</button>
    <button type="button" id="download">Unduh CSV</button>
    <button type="button" id="clear">Hapus Semua</button>
  </form>

  <table id="repairTable">
    <thead>
      <tr>
        <th>No</th><th>Teknisi</th><th>Mesin</th><th>Kerusakan</th><th>Tindakan</th><th>Tanggal</th><th>Shift</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const form = document.getElementById('repairForm');
    const tableBody = document.querySelector('#repairTable tbody');
    const downloadBtn = document.getElementById('download');
    const clearBtn = document.getElementById('clear');

    function saveData(data) {
      localStorage.setItem('repairData', JSON.stringify(data));
    }

    function loadData() {
      return JSON.parse(localStorage.getItem('repairData')) || [];
    }

    function renderTable(data) {
      tableBody.innerHTML = '';
      data.forEach((item, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${index + 1}</td>
                         <td>${item.teknisi}</td>
                         <td>${item.mesin}</td>
                         <td>${item.kerusakan}</td>
                         <td>${item.tindakan}</td>
                         <td>${item.tanggal}</td>
                         <td>${item.shift}</td>`;
        tableBody.appendChild(row);
      });
    }

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      const data = loadData();
      data.push({
        teknisi: teknisi.value,
        mesin: mesin.value,
        kerusakan: kerusakan.value,
        tindakan: tindakan.value,
        tanggal: tanggal.value,
        shift: shift.value
      });
      saveData(data);
      renderTable(data);
      form.reset();
    });

    downloadBtn.addEventListener('click', function () {
      const data = loadData();
      let csv = 'No,Teknisi,Mesin,Kerusakan,Tindakan,Tanggal,Shift\n';
      data.forEach((item, index) => {
        csv += `${index + 1},${item.teknisi},${item.mesin},${item.kerusakan},${item.tindakan},${item.tanggal},${item.shift}\n`;
      });
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'rekap_perbaikan.csv';
      a.click();
      URL.revokeObjectURL(url);
    });

    clearBtn.addEventListener('click', function () {
      localStorage.removeItem('repairData');
      renderTable([]);
    });

    // Load data saat halaman dibuka
    document.addEventListener('DOMContentLoaded', () => {
      renderTable(loadData());
    });
  </script>
</body>
</html>
